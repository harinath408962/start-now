<script type="module">
  import {
    collection,
    query,
    where,
    getDocs
  } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

  async function loadDiary() {
    const user = window.auth.currentUser;
    if (!user) return;

    const q = query(
      collection(window.db, "dailyDiary"),
      where("userId", "==", user.uid)
    );

    const snapshot = await getDocs(q);

    snapshot.forEach(doc => {
      console.log(doc.data());
    });
  }

  window.onload = loadDiary;
</script>

<script>
  if (!localStorage.getItem("firebase:authUser")) {
    window.location.href = "signin.html";
  }
</script>

<script type="module">
  import { onAuthStateChanged } 
  from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";

  onAuthStateChanged(window.auth, (user) => {
    if (!user) {
      window.location.href = "signin.html";
    }
  });
</script>
